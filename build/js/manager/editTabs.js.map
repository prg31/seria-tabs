{"version":3,"file":"editTabs.js","mappings":"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","sources":["webpack:///./src/js/manager/editTabs.js"],"sourcesContent":["window.addEventListener('DOMContentLoaded', () => {\r\n\r\n    document.querySelectorAll('.delete-attribute').forEach( link => {\r\n        link.addEventListener('click', deleteAttr)\r\n    });\r\n\r\n    document.querySelectorAll('form').forEach( form => {\r\n        form.addEventListener('submit', sendForm)\r\n    })\r\n});\r\n\r\nconst deleteAttr = event => {\r\n\r\n    event.preventDefault();\r\n\r\n    const dbID = event.target.dataset.id;\r\n    const path = '/edit-tabs.php?method=' + event.target.dataset.action;\r\n    const url = new URL( path, window.location.origin ).toString();\r\n\r\n    const undo = confirm(\"Вы действительно хотите удалить атрибут? Действия будут применены безвозвратно\");\r\n    if (!undo) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append('id', dbID);\r\n\r\n    if (event.target.dataset.type !== undefined) {\r\n        formData.append('type', event.target.dataset.type)\r\n    }\r\n\r\n    fetch(url, { method: 'POST', body: formData })\r\n    .then(response => response.json())\r\n    .then( response => {\r\n\r\n        if (response.status === 'error') {\r\n            errorAlert(event.target, response.text);\r\n        } else {\r\n            successAlert(event.target, response.text);\r\n            document.querySelector(`#attribute-${dbID}`).remove();\r\n        }\r\n    });\r\n};\r\n\r\nconst sendForm = event => {\r\n\r\n    event.preventDefault();\r\n\r\n    const action = event.target.getAttribute('action');\r\n    const path = new URL( action, window.location.origin ).toString();\r\n\r\n    const formData = new FormData();\r\n    event.target.querySelectorAll('input, select').forEach(input => {\r\n\r\n        if (input.type === 'file') {\r\n            for (const file of input.files) {\r\n                formData.append(input.getAttribute('id'), file, file.name)\r\n            }\r\n        } else {\r\n            formData.append( input.getAttribute('id'), input.value );\r\n        }\r\n    });\r\n\r\n    //seriaId is init in html template <script> tag in header\r\n    formData.append('seriaId', seriaId);\r\n\r\n    fetch(path, { method: 'POST', body: formData })\r\n    .then(response => response.json())\r\n    .then( response => {\r\n\r\n        if (response.status === 'error') {\r\n            errorAlert(event.target, response.text);\r\n        }\r\n        else {\r\n            successAlert(event.target, response.text);\r\n        }\r\n\r\n        //clear inputs if needed\r\n        if (event.target.dataset.flushinputs === 'true') {\r\n            event.target.querySelectorAll('input').forEach(input => {\r\n                input.value = \"\";\r\n            })\r\n        }\r\n    })\r\n}\r\n\r\nconst errorAlert = (form, text) => {\r\n\r\n    form.querySelectorAll('.alert').forEach( alert => {\r\n        alert.remove();\r\n    })\r\n\r\n    const alert = document.createElement('div');\r\n    alert.classList.add('alert', 'alert-danger');\r\n    alert.setAttribute('role', 'alert');\r\n    alert.innerText = text;\r\n\r\n    form.prepend(alert);\r\n};\r\nconst successAlert = (form, text) => {\r\n\r\n    form.querySelectorAll('.alert').forEach( alert => {\r\n        alert.remove();\r\n    })\r\n\r\n    const alert = document.createElement('div');\r\n    alert.classList.add('alert', 'alert-success');\r\n    alert.setAttribute('role', 'alert');\r\n    alert.innerText = text;\r\n\r\n    form.prepend(alert);\r\n};"],"names":["window","addEventListener","document","querySelectorAll","forEach","link","deleteAttr","form","sendForm","event","preventDefault","dbID","target","dataset","id","path","action","url","URL","location","origin","toString","undo","confirm","formData","FormData","append","type","undefined","fetch","method","body","then","response","json","status","errorAlert","text","successAlert","querySelector","remove","getAttribute","input","files","file","name","value","seriaId","flushinputs","alert","createElement","classList","add","setAttribute","innerText","prepend"],"sourceRoot":""}